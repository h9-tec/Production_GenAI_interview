<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 450">
  <defs>
    <linearGradient id="hsBlue" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#3B82F6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#2563EB;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="hsOrange" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#F97316;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#EA580C;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="hsGreen" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#10B981;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#059669;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="hsPurple" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#8B5CF6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#7C3AED;stop-opacity:1" />
    </linearGradient>
    <filter id="hsShadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.15"/>
    </filter>
    <marker id="hsArrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#64748b"/>
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="900" height="450" fill="#f8fafc"/>
  
  <!-- Title -->
  <text x="450" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#1e293b">Hybrid Search &amp; Reranking Pipeline</text>
  
  <!-- Query Input -->
  <rect x="30" y="80" width="120" height="60" rx="10" fill="url(#hsBlue)" filter="url(#hsShadow)"/>
  <text x="90" y="115" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="white" font-weight="bold">Query</text>
  
  <!-- Split arrow -->
  <path d="M150 110 L200 110" stroke="#64748b" stroke-width="2"/>
  <path d="M200 110 L200 70" stroke="#64748b" stroke-width="2"/>
  <path d="M200 110 L200 150" stroke="#64748b" stroke-width="2"/>
  <path d="M200 70 L240 70" stroke="#64748b" stroke-width="2" marker-end="url(#hsArrow)"/>
  <path d="M200 150 L240 150" stroke="#64748b" stroke-width="2" marker-end="url(#hsArrow)"/>
  
  <!-- Dense Retrieval -->
  <rect x="250" y="40" width="150" height="60" rx="10" fill="url(#hsOrange)" filter="url(#hsShadow)"/>
  <text x="325" y="65" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white" font-weight="bold">Dense Retrieval</text>
  <text x="325" y="82" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Vector Search</text>
  
  <!-- Sparse Retrieval -->
  <rect x="250" y="120" width="150" height="60" rx="10" fill="url(#hsGreen)" filter="url(#hsShadow)"/>
  <text x="325" y="145" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white" font-weight="bold">Sparse Retrieval</text>
  <text x="325" y="162" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">BM25 / Keywords</text>
  
  <!-- Arrows to fusion -->
  <path d="M400 70 L450 70 L450 110 L480 110" stroke="#64748b" stroke-width="2"/>
  <path d="M400 150 L450 150 L450 110 L480 110" stroke="#64748b" stroke-width="2" marker-end="url(#hsArrow)"/>
  
  <!-- Score Fusion -->
  <rect x="490" y="75" width="140" height="70" rx="10" fill="url(#hsPurple)" filter="url(#hsShadow)"/>
  <text x="560" y="100" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white" font-weight="bold">Score Fusion</text>
  <text x="560" y="118" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">RRF / Weighted</text>
  <text x="560" y="135" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#E9D5FF">Top 100 candidates</text>
  
  <!-- Arrow to reranker -->
  <path d="M630 110 L680 110" stroke="#64748b" stroke-width="2" marker-end="url(#hsArrow)"/>
  
  <!-- Reranker -->
  <rect x="690" y="75" width="140" height="70" rx="10" fill="url(#hsBlue)" filter="url(#hsShadow)"/>
  <text x="760" y="100" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white" font-weight="bold">Reranker</text>
  <text x="760" y="118" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Cross-Encoder</text>
  <text x="760" y="135" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#BFDBFE">Top 10 results</text>
  
  <!-- Why Hybrid Section -->
  <rect x="30" y="200" width="400" height="220" rx="12" fill="white" stroke="#e2e8f0" stroke-width="2" filter="url(#hsShadow)"/>
  <text x="230" y="230" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" fill="#1e293b" font-weight="bold">Why Hybrid Search?</text>
  
  <text x="50" y="260" font-family="Arial, sans-serif" font-size="12" fill="#dc2626" font-weight="bold">Vector-Only Failures:</text>
  <text x="50" y="280" font-family="Arial, sans-serif" font-size="11" fill="#64748b">â€¢ Exact match blindness (Error Code E-5023)</text>
  <text x="50" y="298" font-family="Arial, sans-serif" font-size="11" fill="#64748b">â€¢ Rare term ignorance (product IDs, acronyms)</text>
  <text x="50" y="316" font-family="Arial, sans-serif" font-size="11" fill="#64748b">â€¢ Negation confusion ("not working" â‰ˆ "working")</text>
  
  <text x="50" y="345" font-family="Arial, sans-serif" font-size="12" fill="#16a34a" font-weight="bold">Hybrid Advantage:</text>
  <text x="50" y="365" font-family="Arial, sans-serif" font-size="11" fill="#64748b">â€¢ BM25 and vector fail on DIFFERENT queries</text>
  <text x="50" y="383" font-family="Arial, sans-serif" font-size="11" fill="#64748b">â€¢ Combined coverage compensates weaknesses</text>
  
  <rect x="50" y="400" width="360" height="25" rx="4" fill="#D1FAE5"/>
  <text x="230" y="417" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#065F46" font-weight="bold">+15-30% precision improvement in enterprise deployments</text>
  
  <!-- RRF Formula Section -->
  <rect x="470" y="200" width="400" height="220" rx="12" fill="white" stroke="#e2e8f0" stroke-width="2" filter="url(#hsShadow)"/>
  <text x="670" y="230" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" fill="#1e293b" font-weight="bold">Reciprocal Rank Fusion (RRF)</text>
  
  <rect x="490" y="250" width="360" height="50" rx="8" fill="#f1f5f9"/>
  <text x="670" y="280" text-anchor="middle" font-family="monospace" font-size="14" fill="#1e293b">RRF(doc) = Î£ 1/(k + rank_i(doc))</text>
  
  <text x="490" y="325" font-family="Arial, sans-serif" font-size="11" fill="#475569">â€¢ k = constant (typically 60)</text>
  <text x="490" y="345" font-family="Arial, sans-serif" font-size="11" fill="#475569">â€¢ rank_i = document's rank in system i</text>
  <text x="490" y="365" font-family="Arial, sans-serif" font-size="11" fill="#475569">â€¢ No score normalization needed</text>
  <text x="490" y="385" font-family="Arial, sans-serif" font-size="11" fill="#475569">â€¢ Favors docs appearing high in multiple systems</text>
  
  <rect x="490" y="400" width="360" height="25" rx="4" fill="#FEF3C7"/>
  <text x="670" y="417" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#92400E" font-weight="bold">ðŸ’¡ Reranking: Highest ROI optimization for most RAG systems</text>
</svg>
